
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>forestci.forestci &#8212; forestci 0.4 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-forestci.forestci">
<span id="forestci-forestci"></span><h1><a class="reference internal" href="#module-forestci.forestci" title="forestci.forestci"><code class="xref py py-mod docutils literal notranslate"><span class="pre">forestci.forestci</span></code></a><a class="headerlink" href="#module-forestci.forestci" title="Permalink to this headline">¶</a></h1>
<p><p>Forest confidence intervals.</p>
<p>Calculate confidence intervals for scikit-learn RandomForestRegressor and
RandomForestClassifier predictions.</p>
</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="forestci.forestci.calc_inbag">
<code class="sig-prename descclassname">forestci.forestci.</code><code class="sig-name descname">calc_inbag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_samples</span></em>, <em class="sig-param"><span class="n">forest</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/forestci/forestci.html#calc_inbag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#forestci.forestci.calc_inbag" title="Permalink to this definition">¶</a></dt>
<dd><p>Derive samples used to create trees in scikit-learn RandomForest objects.</p>
<p>Recovers the samples in each tree from the random state of that tree using
<code class="xref py py-func docutils literal notranslate"><span class="pre">forest._generate_sample_indices()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_samples</strong><span class="classifier">int</span></dt><dd><p>The number of samples used to fit the scikit-learn RandomForest object.</p>
</dd>
<dt><strong>forest</strong><span class="classifier">RandomForest</span></dt><dd><p>Regressor or Classifier object that is already fit by scikit-learn.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Array that records how many times a data point was placed in a tree.</dt><dd></dd>
<dt>Columns are individual trees. Rows are the number of times a sample was</dt><dd></dd>
<dt>used in a tree.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="forestci.forestci._core_computation">
<code class="sig-prename descclassname">forestci.forestci.</code><code class="sig-name descname">_core_computation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_train</span></em>, <em class="sig-param"><span class="n">X_test</span></em>, <em class="sig-param"><span class="n">inbag</span></em>, <em class="sig-param"><span class="n">pred_centered</span></em>, <em class="sig-param"><span class="n">n_trees</span></em>, <em class="sig-param"><span class="n">memory_constrained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">memory_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">test_mode</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/forestci/forestci.html#_core_computation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#forestci.forestci._core_computation" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function, that performs the core computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X_train</strong><span class="classifier">ndarray</span></dt><dd><p>An array with shape (n_train_sample, n_features).</p>
</dd>
<dt><strong>X_test</strong><span class="classifier">ndarray</span></dt><dd><p>An array with shape (n_test_sample, n_features).</p>
</dd>
<dt><strong>inbag</strong><span class="classifier">ndarray</span></dt><dd><p>The inbag matrix that fit the data. If set to <cite>None</cite> (default) it
will be inferred from the forest. However, this only works for trees
for which bootstrapping was set to <cite>True</cite>. That is, if sampling was
done with replacement. Otherwise, users need to provide their own
inbag matrix.</p>
</dd>
<dt><strong>pred_centered</strong><span class="classifier">ndarray</span></dt><dd><p>Centered predictions that are an intermediate result in the
computation.</p>
</dd>
<dt><strong>memory_constrained: boolean (optional)</strong></dt><dd><p>Whether or not there is a restriction on memory. If False, it is
assumed that a ndarry of shape (n_train_sample,n_test_sample) fits
in main memory. Setting to True can actually provide a speed up if
memory_limit is tuned to the optimal range.</p>
</dd>
<dt><strong>memory_limit: int (optional)</strong></dt><dd><p>An upper bound for how much memory the itermediate matrices will take
up in Megabytes. This must be provided if memory_constrained=True.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="forestci.forestci._bias_correction">
<code class="sig-prename descclassname">forestci.forestci.</code><code class="sig-name descname">_bias_correction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">V_IJ</span></em>, <em class="sig-param"><span class="n">inbag</span></em>, <em class="sig-param"><span class="n">pred_centered</span></em>, <em class="sig-param"><span class="n">n_trees</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/forestci/forestci.html#_bias_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#forestci.forestci._bias_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper functions that implements bias correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>V_IJ</strong><span class="classifier">ndarray</span></dt><dd><p>Intermediate result in the computation.</p>
</dd>
<dt><strong>inbag</strong><span class="classifier">ndarray</span></dt><dd><p>The inbag matrix that fit the data. If set to <cite>None</cite> (default) it
will be inferred from the forest. However, this only works for trees
for which bootstrapping was set to <cite>True</cite>. That is, if sampling was
done with replacement. Otherwise, users need to provide their own
inbag matrix.</p>
</dd>
<dt><strong>pred_centered</strong><span class="classifier">ndarray</span></dt><dd><p>Centered predictions that are an intermediate result in the
computation.</p>
</dd>
<dt><strong>n_trees</strong><span class="classifier">int</span></dt><dd><p>The number of trees in the forest object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="forestci.forestci.random_forest_error">
<code class="sig-prename descclassname">forestci.forestci.</code><code class="sig-name descname">random_forest_error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forest</span></em>, <em class="sig-param"><span class="n">X_train</span></em>, <em class="sig-param"><span class="n">X_test</span></em>, <em class="sig-param"><span class="n">inbag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calibrate</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">memory_constrained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">memory_limit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/forestci/forestci.html#random_forest_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#forestci.forestci.random_forest_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate error bars from scikit-learn RandomForest estimators.</p>
<p>RandomForest is a regressor or classifier object
this variance can be used to plot error bars for RandomForest objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>forest</strong><span class="classifier">RandomForest</span></dt><dd><p>Regressor or Classifier object.</p>
</dd>
<dt><strong>X_train</strong><span class="classifier">ndarray</span></dt><dd><p>An array with shape (n_train_sample, n_features). The design matrix for
training data.</p>
</dd>
<dt><strong>X_test</strong><span class="classifier">ndarray</span></dt><dd><p>An array with shape (n_test_sample, n_features). The design matrix
for testing data</p>
</dd>
<dt><strong>inbag</strong><span class="classifier">ndarray, optional</span></dt><dd><p>The inbag matrix that fit the data. If set to <cite>None</cite> (default) it
will be inferred from the forest. However, this only works for trees
for which bootstrapping was set to <cite>True</cite>. That is, if sampling was
done with replacement. Otherwise, users need to provide their own
inbag matrix.</p>
</dd>
<dt><strong>calibrate: boolean, optional</strong></dt><dd><p>Whether to apply calibration to mitigate Monte Carlo noise.
Some variance estimates may be negative due to Monte Carlo effects if
the number of trees in the forest is too small. To use calibration,
Default: True</p>
</dd>
<dt><strong>memory_constrained: boolean, optional</strong></dt><dd><p>Whether or not there is a restriction on memory. If False, it is
assumed that a ndarry of shape (n_train_sample,n_test_sample) fits
in main memory. Setting to True can actually provide a speed up if
memory_limit is tuned to the optimal range.</p>
</dd>
<dt><strong>memory_limit: int, optional.</strong></dt><dd><p>An upper bound for how much memory the itermediate matrices will take
up in Megabytes. This must be provided if memory_constrained=True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>An array with the unbiased sampling variance (V_IJ_unbiased)</dt><dd></dd>
<dt>for a RandomForest object.</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#forestci.forestci.calc_inbag" title="forestci.forestci.calc_inbag"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_inbag()</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The calculation of error is based on the infinitesimal jackknife variance,
as described in <a class="reference internal" href="../index.html#ra85e16819288-wager2014" id="id1">[Wager2014]</a> and is a Python implementation of the R code
provided at: <a class="reference external" href="https://github.com/swager/randomForestCI">https://github.com/swager/randomForestCI</a></p>
<dl class="citation">
<dt class="label" id="ra85e16819288-wager2014"><span class="brackets"><a class="fn-backref" href="#id1">Wager2014</a></span></dt>
<dd><p>S. Wager, T. Hastie, B. Efron. “Confidence Intervals for
Random Forests: The Jackknife and the Infinitesimal Jackknife”, Journal
of Machine Learning Research vol. 15, pp. 1625-1651, 2014.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/escience-logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016--, Kivan Polimis, Ariel Rokem, Bryna Hazelton, The University of Washington.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/autoapi/forestci/forestci/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>