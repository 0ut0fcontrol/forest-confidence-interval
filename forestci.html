
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Random Forest Confidence Intervals &#8212; forestci 0.4 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="random-forest-confidence-intervals">
<h1>Random Forest Confidence Intervals<a class="headerlink" href="#random-forest-confidence-intervals" title="Permalink to this headline">¶</a></h1>
<p>This module creates an in-bag and calculates the variance of a prediction for
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor" title="(in scikit-learn v0.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.ensemble.RandomForestRegressor</span></code></a> or
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier" title="(in scikit-learn v0.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.ensemble.RandomForestClassifier</span></code></a> objects. This variance in the
prediction is calculated using the <a class="reference internal" href="index.html#wager2014" id="id1"><span>[Wager2014]</span></a> infinitesimal jackknife variance
method. The variance can be used to plot error bars for RandomForest objects</p>
<p>See the <a class="reference external" href="https://github.com/scikit-learn-contrib/forest-confidence-interval/blob/master/README.md">README</a>
for more information.</p>
<span class="target" id="module-forestci"></span><dl class="py function">
<dt id="forestci.calc_inbag">
<code class="sig-prename descclassname">forestci.</code><code class="sig-name descname">calc_inbag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_samples</span></em>, <em class="sig-param"><span class="n">forest</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/forestci/forestci.html#calc_inbag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#forestci.calc_inbag" title="Permalink to this definition">¶</a></dt>
<dd><p>Derive samples used to create trees in scikit-learn RandomForest objects.</p>
<p>Recovers the samples in each tree from the random state of that tree using
<code class="xref py py-func docutils literal notranslate"><span class="pre">forest._generate_sample_indices()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_samples</strong><span class="classifier">int</span></dt><dd><p>The number of samples used to fit the scikit-learn RandomForest object.</p>
</dd>
<dt><strong>forest</strong><span class="classifier">RandomForest</span></dt><dd><p>Regressor or Classifier object that is already fit by scikit-learn.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Array that records how many times a data point was placed in a tree.</dt><dd></dd>
<dt>Columns are individual trees. Rows are the number of times a sample was</dt><dd></dd>
<dt>used in a tree.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="forestci.random_forest_error">
<code class="sig-prename descclassname">forestci.</code><code class="sig-name descname">random_forest_error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forest</span></em>, <em class="sig-param"><span class="n">X_train</span></em>, <em class="sig-param"><span class="n">X_test</span></em>, <em class="sig-param"><span class="n">inbag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">calibrate</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">memory_constrained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">memory_limit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/forestci/forestci.html#random_forest_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#forestci.random_forest_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate error bars from scikit-learn RandomForest estimators.</p>
<p>RandomForest is a regressor or classifier object
this variance can be used to plot error bars for RandomForest objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>forest</strong><span class="classifier">RandomForest</span></dt><dd><p>Regressor or Classifier object.</p>
</dd>
<dt><strong>X_train</strong><span class="classifier">ndarray</span></dt><dd><p>An array with shape (n_train_sample, n_features). The design matrix for
training data.</p>
</dd>
<dt><strong>X_test</strong><span class="classifier">ndarray</span></dt><dd><p>An array with shape (n_test_sample, n_features). The design matrix
for testing data</p>
</dd>
<dt><strong>inbag</strong><span class="classifier">ndarray, optional</span></dt><dd><p>The inbag matrix that fit the data. If set to <cite>None</cite> (default) it
will be inferred from the forest. However, this only works for trees
for which bootstrapping was set to <cite>True</cite>. That is, if sampling was
done with replacement. Otherwise, users need to provide their own
inbag matrix.</p>
</dd>
<dt><strong>calibrate: boolean, optional</strong></dt><dd><p>Whether to apply calibration to mitigate Monte Carlo noise.
Some variance estimates may be negative due to Monte Carlo effects if
the number of trees in the forest is too small. To use calibration,
Default: True</p>
</dd>
<dt><strong>memory_constrained: boolean, optional</strong></dt><dd><p>Whether or not there is a restriction on memory. If False, it is
assumed that a ndarry of shape (n_train_sample,n_test_sample) fits
in main memory. Setting to True can actually provide a speed up if
memory_limit is tuned to the optimal range.</p>
</dd>
<dt><strong>memory_limit: int, optional.</strong></dt><dd><p>An upper bound for how much memory the itermediate matrices will take
up in Megabytes. This must be provided if memory_constrained=True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>An array with the unbiased sampling variance (V_IJ_unbiased)</dt><dd></dd>
<dt>for a RandomForest object.</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#forestci.calc_inbag" title="forestci.calc_inbag"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_inbag()</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The calculation of error is based on the infinitesimal jackknife variance,
as described in <a class="reference internal" href="#rc1fb17d90f4d-wager2014" id="id2">[Wager2014]</a> and is a Python implementation of the R code
provided at: <a class="reference external" href="https://github.com/swager/randomForestCI">https://github.com/swager/randomForestCI</a></p>
<dl class="citation">
<dt class="label" id="rc1fb17d90f4d-wager2014"><span class="brackets"><a class="fn-backref" href="#id2">Wager2014</a></span></dt>
<dd><p>S. Wager, T. Hastie, B. Efron. “Confidence Intervals for
Random Forests: The Jackknife and the Infinitesimal Jackknife”, Journal
of Machine Learning Research vol. 15, pp. 1625-1651, 2014.</p>
</dd>
</dl>
</dd></dl>

<dl class="citation">
<dt class="label" id="wager2014"><span class="brackets"><a class="fn-backref" href="#id1">Wager2014</a></span></dt>
<dd><p>S. Wager, T. Hastie, B. Efron. “Confidence Intervals for
Random Forests: The Jackknife and the Infinitesimal Jackknife”, Journal
of Machine Learning Research vol. 15, pp. 1625-1651, 2014.</p>
</dd>
</dl>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/escience-logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016--, Kivan Polimis, Ariel Rokem, Bryna Hazelton, The University of Washington.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/forestci.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>